/*
 * to-markdown - an HTML to Markdown converter
 *
 * Copyright 2011, Dom Christie
 * Licenced under the MIT licence
 *
 */
var toMarkdown=function(e){function j(a,b){var c=RegExp("void"===b.type?"<"+b.tag+"\\b([^>]*)\\/?>":"<"+b.tag+"\\b([^>]*)>([\\s\\S]*?)<\\/"+b.tag+">","gi"),d="";return d="string"===typeof b.replacement?a.replace(c,b.replacement):a.replace(c,function(a,c,d,e){return b.replacement.call(this,a,c,d,e)})}function g(a){return RegExp(a+"\\s*=\\s*[\"']?([^\"']*)[\"']?","i")}function l(a){a=a.replace(/<(ul|ol)\b[^>]*>([\s\S]*?)<\/\1>/gi,function(b,a,e){b=e.split("</li>");b.splice(b.length-1,1);d=0;for(h=b.length;d<
h;d++)if(b[d]){var f="ol"===a?d+1+".  ":"*   ";b[d]=b[d].replace(/\s*<li[^>]*>([\s\S]*)/i,function(b,a){a=a.replace(/^\s+/,"");a=a.replace(/\n\n/g,"\n\n    ");a=a.replace(/\n([ ]*)+(\*|\d+\.) /g,"\n$1    $2 ");return f+a})}return b.join("\n")});return"\n\n"+a.replace(/[ \t]+\n|\s+$/g,"")}function m(a){return a=a.replace(/<blockquote\b[^>]*>([\s\S]*?)<\/blockquote>/gi,function(a,c){c=c.replace(/^\s+|\s+$/g,"");c=k(c);c=c.replace(/^/gm,"> ");return c=c.replace(/^(>([ \t]{2,}>)+)/gm,"> >")})}function k(a){a=
a.replace(/^[\t\r\n]+|[\t\r\n]+$/g,"");a=a.replace(/\n\s+\n/g,"\n\n");return a=a.replace(/\n{3,}/g,"\n\n")}for(var f=[{patterns:"p",replacement:function(a,b,c){return c?"\n\n"+c+"\n":""}},{patterns:"br",type:"void",replacement:"\n"},{patterns:"h([1-6])",replacement:function(a,b,c,d){a="";for(c=0;c<b;c++)a+="#";return"\n\n"+a+" "+d+"\n"}},{patterns:"hr",type:"void",replacement:"\n\n* * *\n"},{patterns:"a",replacement:function(a,b,c){var d=b.match(g("href")),b=b.match(g("title"));return d?"["+c+"]("+
d[1]+(b&&b[1]?' "'+b[1]+'"':"")+")":a}},{patterns:["b","strong"],replacement:function(a,b,c){return c?"**"+c+"**":""}},{patterns:["i","em"],replacement:function(a,b,c){return c?"_"+c+"_":""}},{patterns:"code",replacement:function(a,b,c){return c?"`"+c+"`":""}},{patterns:"img",type:"void",replacement:function(a,b){var c=b.match(g("src")),d=b.match(g("alt")),e=b.match(g("title"));return"!["+(d&&d[1]?d[1]:"")+"]("+c[1]+(e&&e[1]?' "'+e[1]+'"':"")+")"}}],d=0,h=f.length;d<h;d++)if("string"===typeof f[d].patterns)e=
j(e,{tag:f[d].patterns,replacement:f[d].replacement,type:f[d].type});else for(var i=0,n=f[d].patterns.length;i<n;i++)e=j(e,{tag:f[d].patterns[i],replacement:f[d].replacement,type:f[d].type});e=e.replace(/<pre\b[^>]*>`([\s\S]*?)`<\/pre>/gi,function(a,b){b=b.replace(/^\t+/g,"  ");b=b.replace(/\n/g,"\n    ");return"\n\n    "+b+"\n"});e=e.replace(/(\d+). /g,"$1\\. ");for(f=/<(ul|ol)\b[^>]*>(?:(?!<ul|<ol)[\s\S])*?<\/\1>/gi;e.match(f);)e=e.replace(f,function(a){return l(a)});for(f=/<blockquote\b[^>]*>((?:(?!<blockquote)[\s\S])*?)<\/blockquote>/gi;e.match(f);)e=
e.replace(f,function(a){return m(a)});return k(e)};